# khai b√°o th∆∞ vi·ªán
import os
import cv2
import time
import calendar
import smtplib
import requests
import pygame
import subprocess
import json
import wikipedia
import configparser
from unidecode import unidecode
from tkinter import *
from datetime import datetime
from PIL import Image, ImageTk
from tkinter.scrolledtext import ScrolledText
from tkinter import Tk, ttk, LEFT, W, E, N, S, messagebox, filedialog, colorchooser, simpledialog, filedialog, Listbox, Scrollbar, WORD, END, scrolledtext
import speech_recognition as sr
import librosa
import soundfile as sf
import threading
from tqdm import tqdm 
# T√≠nh nƒÉng 1: ƒê·ªìng h·ªì v√† l·ªãch
def clock():
    # T·∫°o c·ª≠a s·ªï ch√≠nh
    root = Toplevel()
    root.title("1. ƒê·ªìng h·ªì v√† l·ªãch")
    tinh_nang_1 = ttk.Frame(root, padding=20)
    tinh_nang_1.grid()
    # T·∫°o c√°c nh√£n cho ng√†y, gi·ªù v√† l·ªãch
    hom_nay = ttk.Label(tinh_nang_1, text="", anchor="center", font=("Helvetica", 16))
    hom_nay.grid(column=0, row=0, columnspan=2, pady=5)
    thoi_gian = ttk.Label(tinh_nang_1, text="", anchor="center", font=("Helvetica", 24, "bold"))
    thoi_gian.grid(column=0, row=1, columnspan=2, pady=5)
    calendar_label = ttk.Label(tinh_nang_1, text="", anchor="center", justify=LEFT, font=("Courier New", 12))
    calendar_label.grid(column=0, row=2, columnspan=2, pady=5)
    def update_clock():
        # L·∫•y ng√†y v√† gi·ªù hi·ªán t·∫°i
        hom_nay_data = datetime.now().strftime("%d-%m-%Y")
        thoi_gian_data = datetime.now().strftime("%H:%M:%S")
        # C·∫≠p nh·∫≠t c√°c nh√£n
        hom_nay.config(text=f"Ng√†y h√¥m nay: {hom_nay_data}")
        thoi_gian.config(text=f"Th·ªùi gian: {thoi_gian_data}")
        root.after(1000, update_clock)
    # L·∫•y l·ªãch c·∫£ nƒÉm
    text_calendar = calendar.TextCalendar()
    year = datetime.now().year
    all_lich = text_calendar.formatyear(year)
    calendar_label.config(text=f"L·ªãch nƒÉm nay: {all_lich}")
    # G·ªçi h√†m update_clock ban ƒë·∫ßu ƒë·ªÉ hi·ªÉn th·ªã ƒë·ªìng h·ªì ngay l·∫≠p t·ª©c
    update_clock()
    root.mainloop()
# T√≠nh nƒÉng 2: M√°y ·∫£nh
recording = False
video_writer = None
def camera():
    global recording, video_writer
    root = Toplevel()
    root.title("2. M√°y ·∫£nh")
    cap = cv2.VideoCapture(0)

    tinh_nang_2 = ttk.Frame(root, padding=20)
    tinh_nang_2.grid()
    label = Label(tinh_nang_2)
    label.grid(column=0, row=0, columnspan=2, sticky="ew")

    def update_frame():
        ret, frame = cap.read()
        if ret:
            frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
            img = Image.fromarray(frame)
            img_tk = ImageTk.PhotoImage(image=img)
            label.img_tk = img_tk
            label.config(image=img_tk)
            if recording and video_writer is not None:
                frame_bgr = cv2.cvtColor(frame, cv2.COLOR_RGB2BGR)
                video_writer.write(frame_bgr)
        root.after(10, update_frame)

    def on_closing():
        cap.release()
        if video_writer is not None:
            video_writer.release()
        root.destroy()

    def chup_anh():
        ret, frame = cap.read()
        if ret:
            filename = datetime.now().strftime("%Y%m%d_%H%M%S") + ".jpg"
            cv2.imwrite(filename, frame)
            print(f"·∫¢nh ƒë√£ ƒë∆∞·ª£c l∆∞u: {filename}")

    def quay_video():
        global recording, video_writer
        if not recording:
            recording = True
            filename = datetime.now().strftime("%Y%m%d_%H%M%S") + ".avi"
            fourcc = cv2.VideoWriter_fourcc(*'XVID')
            video_writer = cv2.VideoWriter(filename, fourcc, 20.0, (640, 480))
            print(f"B·∫Øt ƒë·∫ßu quay video: {filename}")
        else:
            recording = False
            if video_writer is not None:
                video_writer.release()
                print("D·ª´ng quay video")
            video_writer = None

    def mo_kho_luu_tru():
        os.startfile(os.getcwd())

    ttk.Button(tinh_nang_2, text="Ch·ª•p ·∫£nh", command=chup_anh).grid(column=0, row=1, columnspan=2, sticky="ew")
    ttk.Button(tinh_nang_2, text="Quay video", command=quay_video).grid(column=0, row=2, columnspan=2, sticky="ew")
    ttk.Button(tinh_nang_2, text="Kho l∆∞u tr·ªØ", command=mo_kho_luu_tru).grid(column=0, row=3, columnspan=2, sticky="ew")

    root.protocol("WM_DELETE_WINDOW", on_closing)
    update_frame()
    root.mainloop()
# T√≠nh nƒÉng 3: G·ª≠i th∆∞  
def gui_thu():
    SENDER_EMAIL = "ungdungthu3@gmail.com"
    SENDER_PASSWORD = "dvmq ponq gplj awdq"
    def send_email():
        try:
            server = smtplib.SMTP("smtp.gmail.com", 587)
            server.starttls()
            server.login(SENDER_EMAIL, SENDER_PASSWORD)
            email_message = f"Subject: {subject_entry.get()}\n\n{message_text.get('1.0', END)}".encode("utf-8")
            server.sendmail(SENDER_EMAIL, recipient_entry.get(), email_message)
            server.quit()
            messagebox.showinfo("Th√†nh c√¥ng", "Email ƒë√£ ƒë∆∞·ª£c g·ª≠i!")
        except Exception as e:
            messagebox.showerror("L·ªói", f"Kh√¥ng th·ªÉ g·ª≠i email: {e}")

    root = Toplevel()
    root.title("3.G·ª≠i th∆∞")

    Label(root, text="Ng∆∞·ªùi g·ª≠i:").grid(row=0, column=0)
    Label(root, text=SENDER_EMAIL).grid(row=0, column=1)

    Label(root, text="Ng∆∞·ªùi nh·∫≠n:").grid(row=1, column=0)
    recipient_entry = Entry(root, width=40); recipient_entry.grid(row=1, column=1)

    Label(root, text="Ch·ªß ƒë·ªÅ:").grid(row=2, column=0)
    subject_entry = Entry(root, width=40); subject_entry.grid(row=2, column=1)

    Label(root, text="N·ªôi dung:").grid(row=3, column=0)
    message_text = Text(root, height=10, width=50); message_text.grid(row=3, column=1)

    Button(root, text="G·ª≠i", command=send_email).grid(row=4, column=1)
    
    root.mainloop()
# T√≠nh nƒÉng 4: M√°y t√≠nh
def may_tinh():
    root = Toplevel()
    root.title("4. M√°y t√≠nh")
    root.resizable(False, False)

    expression = ""     # Bi·∫øn n√†y ƒë·ªÉ l∆∞u tr·ªØ bi·ªÉu th·ª©c hi·ªán t·∫°i

    # H√†m c·∫≠p nh·∫≠t √¥ nh·∫≠p li·ªáu
    def update_entry(value):
        nonlocal expression
        expression += str(value)
        entry.delete(0, END)
        entry.insert(0, expression)
    # H√†m x√≥a to√†n b·ªô √¥ nh·∫≠p li·ªáu 
    def clear_entry():
        nonlocal expression
        expression = ""
        entry.delete(0, END)
    # H√†m t√≠nh to√°n k·∫øt qu·∫£
    def calculate_result():
        nonlocal expression
        try:
            # Thay th·∫ø c√°c k√Ω hi·ªáu to√°n h·ªçc v·ªõi ng∆∞·ªùi d√πng th√†nh to√°n t·ª≠ Python
            eval_expression = expression.replace("x", "*").replace(":", "/").replace(",", ".")
            # ƒê√°nh gi√° bi·ªÉu th·ª©c
            result = str(eval(eval_expression))
            entry.delete(0, END)
            entry.insert(0, result)
            expression = result # L∆∞u k·∫øt qu·∫£ ƒë·ªÉ c√≥ th·ªÉ ti·∫øp t·ª•c t√≠nh to√°n
        except Exception as e:
            # Hi·ªÉn th·ªã th√¥ng b√°o l·ªói
            messagebox.showerror("L·ªói", "Bi·ªÉu th·ª©c kh√¥ng h·ª£p l·ªá ho·∫∑c l·ªói: " + str(e))
            expression = "" # ƒê·∫∑t l·∫°i bi·ªÉu th·ª©c khi c√≥ l·ªói
    # H√†m x√≥a k√Ω t·ª± cu·ªëi c√πng 
    def delete_last_char():
        nonlocal expression
        expression = expression[:-1] # C·∫Øt b·ªè k√Ω t·ª± cu·ªëi c√πng
        entry.delete(0, END)
        entry.insert(0, expression)
    # Khung ch·ª©a c√°c ph√≠m
    tinh_nang_4 = ttk.Frame(root, padding="10 10 10 10")
    tinh_nang_4.grid(row=0, column=0, sticky=(N, W, E, S))
    root.grid_columnconfigure(0, weight=1)
    root.grid_rowconfigure(0, weight=1)
    # √î nh·∫≠p li·ªáu hi·ªÉn th·ªã bi·ªÉu th·ª©c v√† k·∫øt qu·∫£
    entry = Entry(tinh_nang_4, width=25, font=('Arial', 14), justify='right')
    entry.grid(row=0, column=0, columnspan=5, pady=10, ipadx=5, ipady=5)
    # C√°c n√∫t h√†ng 1
    ttk.Button(tinh_nang_4, text="AC", command=clear_entry, width=5).grid(column=0, row=1, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="(", command=lambda: update_entry("("), width=5).grid(column=1, row=1, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text=")", command=lambda: update_entry(")"), width=5).grid(column=2, row=1, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text=":", command=lambda: update_entry(":"), width=5).grid(column=3, row=1, padx=2, pady=2) 
    # C√°c n√∫t h√†ng 2
    ttk.Button(tinh_nang_4, text="7", command=lambda: update_entry("7"), width=5).grid(column=0, row=2, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="8", command=lambda: update_entry("8"), width=5).grid(column=1, row=2, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="9", command=lambda: update_entry("9"), width=5).grid(column=2, row=2, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="x", command=lambda: update_entry("x"), width=5).grid(column=3, row=2, padx=2, pady=2) 
    # C√°c n√∫t h√†ng 3
    ttk.Button(tinh_nang_4, text="4", command=lambda: update_entry("4"), width=5).grid(column=0, row=3, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="5", command=lambda: update_entry("5"), width=5).grid(column=1, row=3, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="6", command=lambda: update_entry("6"), width=5).grid(column=2, row=3, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="-", command=lambda: update_entry("-"), width=5).grid(column=3, row=3, padx=2, pady=2) 
    # C√°c n√∫t h√†ng 4
    ttk.Button(tinh_nang_4, text="1", command=lambda: update_entry("1"), width=5).grid(column=0, row=4, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="2", command=lambda: update_entry("2"), width=5).grid(column=1, row=4, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="3", command=lambda: update_entry("3"), width=5).grid(column=2, row=4, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="+", command=lambda: update_entry("+"), width=5).grid(column=3, row=4, padx=2, pady=2) 
    # C√°c n√∫t h√†ng 5
    ttk.Button(tinh_nang_4, text="0", command=lambda: update_entry("0"), width=11).grid(column=0, row=5, columnspan=2, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text=".", command=lambda: update_entry("."), width=5).grid(column=2, row=5, padx=2, pady=2)
    ttk.Button(tinh_nang_4, text="=", command=calculate_result, width=5).grid(column=3, row=5, padx=2, pady=2)
    # N√∫t x√≥a k√Ω t·ª± cu·ªëi c√πng
    ttk.Button(tinh_nang_4, text="X√≥a", command=delete_last_char, width=5).grid(column=4, row=1, padx=2, pady=2)
    root.mainloop()
# T√≠nh nƒÉng 5: Chuy·ªÉn √¢m thanh th√†nh vƒÉn b·∫£n
def chuyen_am_thanh_thanh_van_ban():
    def update_progress(message):
        text_area.delete(1.0, END)
        text_area.insert(END, message + "\n")
        text_area.update_idletasks() # ƒê·∫£m b·∫£o giao di·ªán ng∆∞·ªùi d√πng c·∫≠p nh·∫≠t ngay l·∫≠p t·ª©c

    def convert_audio_to_text(file_path=None, language="vi-VN", use_microphone=False):

        recognizer = sr.Recognizer()

        try:
            update_progress("ƒêang x·ª≠ l√Ω √¢m thanh...")

            if use_microphone:
                with sr.Microphone() as source:
                    update_progress("N√≥i v√†o micro...")
                    # ƒêi·ªÅu ch·ªânh ti·∫øng ·ªìn xung quanh tr∆∞·ªõc khi l·∫Øng nghe
                    recognizer.adjust_for_ambient_noise(source)
                    # L·∫Øng nghe ƒë·∫ßu v√†o √¢m thanh t·ª´ micro
                    recorded_data = recognizer.listen(source)
            else:
                if not file_path:
                    update_progress("L·ªói: Kh√¥ng c√≥ ƒë∆∞·ªùng d·∫´n file MP3.")
                    return

                update_progress("ƒêang t·∫£i file MP3 v√† chuy·ªÉn ƒë·ªïi...")
                # T·∫£i MP3 b·∫±ng librosa, gi·ªØ nguy√™n t·ªëc ƒë·ªô m·∫´u g·ªëc
                y, sr_rate = librosa.load(file_path, sr=None)
                # Ghi v√†o m·ªôt file WAV t·∫°m th·ªùi v√¨ SpeechRecognition ho·∫°t ƒë·ªông t·ªët nh·∫•t v·ªõi WAV
                sf.write("temp_audio.wav", y, sr_rate)

                # M√¥ ph·ªèng thanh ti·∫øn tr√¨nh cho qu√° tr√¨nh x·ª≠ l√Ω file
                for i in range(1, 11): # T·ª´ 10% ƒë·∫øn 100%
                    update_progress(f"Ti·∫øn tr√¨nh t·∫£i v√† x·ª≠ l√Ω: {i * 10}%")
                    time.sleep(0.1) # T·∫°m d·ª´ng nh·ªè ƒë·ªÉ hi·ªÉn th·ªã c·∫≠p nh·∫≠t ti·∫øn tr√¨nh

                with sr.AudioFile("temp_audio.wav") as source:
                    # Ghi l·∫°i to√†n b·ªô file √¢m thanh
                    recorded_data = recognizer.record(source)

            update_progress("ƒêang nh·∫≠n d·∫°ng gi·ªçng n√≥i... (Qu√° tr√¨nh n√†y c√≥ th·ªÉ m·∫•t m·ªôt ch√∫t th·ªùi gian)")
            # S·ª≠ d·ª•ng API Google Web Speech ƒë·ªÉ nh·∫≠n d·∫°ng
            text = recognizer.recognize_google(recorded_data, language=language)

            update_progress("Ho√†n t·∫•t! D∆∞·ªõi ƒë√¢y l√† vƒÉn b·∫£n:")
            text_area.insert(END, f"\n{text}\n")
        except sr.UnknownValueError:
            update_progress("Kh√¥ng th·ªÉ nh·∫≠n d·∫°ng gi·ªçng n√≥i. Vui l√≤ng th·ª≠ l·∫°i.")
        except sr.RequestError as e:
            update_progress(f"Kh√¥ng th·ªÉ k·∫øt n·ªëi v·ªõi d·ªãch v·ª• nh·∫≠n d·∫°ng gi·ªçng n√≥i; {e}")
        except FileNotFoundError:
            update_progress("L·ªói: Kh√¥ng t√¨m th·∫•y file √¢m thanh.")
        except Exception as e:
            # B·∫Øt b·∫•t k·ª≥ l·ªói kh√¥ng mong mu·ªën n√†o kh√°c
            update_progress(f"L·ªói: {e}")

    def select_mp3_file(language="vi-VN"):
        # Y√™u c·∫ßu ng∆∞·ªùi d√πng ch·ªçn m·ªôt file MP3
        file_path = filedialog.askopenfilename(
            title="Ch·ªçn file MP3",
            filetypes=[("MP3 files", "*.mp3"), ("T·∫•t c·∫£ file", "*.*")]
        )
        if file_path:
            # Ch·∫°y qu√° tr√¨nh chuy·ªÉn ƒë·ªïi trong m·ªôt lu·ªìng ri√™ng bi·ªát ƒë·ªÉ gi·ªØ cho GUI ph·∫£n h·ªìi
            threading.Thread(target=convert_audio_to_text,
                             args=(file_path, language, False)).start()

    def start_microphone_recognition(language="vi-VN"):

        # Ch·∫°y nh·∫≠n d·∫°ng micro trong m·ªôt lu·ªìng ri√™ng bi·ªát
        threading.Thread(target=convert_audio_to_text,
                         args=(None, language, True)).start()

    # Thi·∫øt l·∫≠p c·ª≠a s·ªï Tkinter ch√≠nh
    root = Toplevel()
    root.title("5. Chuy·ªÉn √¢m thanh th√†nh vƒÉn b·∫£n")
    root.geometry("700x500") # C·ª≠a s·ªï l·ªõn h∆°n m·ªôt ch√∫t

    # C·∫•u h√¨nh l∆∞·ªõi ƒë·ªÉ ƒë√°p ·ª©ng
    root.grid_rowconfigure(2, weight=1)
    root.grid_columnconfigure(0, weight=1)
    root.grid_columnconfigure(1, weight=1)

    # Khung ch·ª©a c√°c n√∫t
    button_frame = Frame(root, padx=10, pady=10)
    button_frame.grid(row=0, column=0, columnspan=2, pady=10, padx=10, sticky="ew")
    button_frame.grid_columnconfigure(0, weight=1)
    button_frame.grid_columnconfigure(1, weight=1)
    button_frame.grid_columnconfigure(2, weight=1)
    button_frame.grid_columnconfigure(3, weight=1)


    # C√°c n√∫t ƒë·ªÉ ch·ªçn file MP3 (ti·∫øng Vi·ªát v√† ti·∫øng Anh)
    select_button_vi = Button(button_frame, text="Ch·ªçn File MP3 (Ti·∫øng Vi·ªát)",
                              command=lambda: select_mp3_file("vi-VN"),
                              font=("Arial", 10), relief="raised") # ƒê√£ x√≥a thu·ªôc t√≠nh m√†u
    select_button_vi.grid(row=0, column=0, padx=5, pady=5, sticky="ew")

    select_button_en = Button(button_frame, text="Ch·ªçn File MP3 (Ti·∫øng Anh)",
                              command=lambda: select_mp3_file("en-US"),
                              font=("Arial", 10), relief="raised") # ƒê√£ x√≥a thu·ªôc t√≠nh m√†u
    select_button_en.grid(row=0, column=1, padx=5, pady=5, sticky="ew")

    # C√°c n√∫t ƒë·ªÉ nh·∫≠p t·ª´ Micro (ti·∫øng Vi·ªát v√† ti·∫øng Anh)
    mic_button_vi = Button(button_frame, text="Nh·∫≠n d·∫°ng Micro (Ti·∫øng Vi·ªát)",
                           command=lambda: start_microphone_recognition("vi-VN"),
                           font=("Arial", 10), relief="raised") # ƒê√£ x√≥a thu·ªôc t√≠nh m√†u
    mic_button_vi.grid(row=1, column=0, padx=5, pady=5, sticky="ew")

    mic_button_en = Button(button_frame, text="Nh·∫≠n d·∫°ng Micro (Ti·∫øng Anh)",
                           command=lambda: start_microphone_recognition("en-US"),
                           font=("Arial", 10), relief="raised") # ƒê√£ x√≥a thu·ªôc t√≠nh m√†u
    mic_button_en.grid(row=1, column=1, padx=5, pady=5, sticky="ew")

    # Widget ScrolledText ƒë·ªÉ hi·ªÉn th·ªã k·∫øt qu·∫£ v√† ti·∫øn tr√¨nh
    text_area = scrolledtext.ScrolledText(root, wrap=WORD, width=70, height=15,
                                          font=("Arial", 12), bg="#F8F8F8", fg="#333333",
                                          relief="sunken", borderwidth=2)
    text_area.grid(row=2, column=0, padx=10, pady=10, columnspan=2, sticky="nsew")
    text_area.insert(END, "Ch√†o m·ª´ng! Nh·∫•n m·ªôt trong c√°c n√∫t tr√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu chuy·ªÉn ƒë·ªïi √¢m thanh th√†nh vƒÉn b·∫£n.\n")

    # B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p s·ª± ki·ªán Tkinter
    root.mainloop()
# T√≠nh nƒÉng 6: T√¨m ki·∫øm th√¥ng tin
def tim_kiem_thong_tin():
    wikipedia.set_lang("vi")
    def lay_thong_tin():
        noi_dung_tim_kiem = o_nhap.get()
        if not noi_dung_tim_kiem:
            o_ket_qua.delete(1.0, END)
            o_ket_qua.insert(END, "Vui l√≤ng nh·∫≠p t·ª´ kh√≥a t√¨m ki·∫øm.")
            return

        try:
            tom_tat = wikipedia.summary(noi_dung_tim_kiem) 
            o_ket_qua.delete(1.0, END)
            o_ket_qua.insert(END, tom_tat)
        except wikipedia.exceptions.PageError:
            o_ket_qua.delete(1.0, END)
            o_ket_qua.insert(END, f"R·∫•t ti·∫øc, t√¥i kh√¥ng t√¨m th·∫•y th√¥ng tin v·ªÅ '{noi_dung_tim_kiem}'. Vui l√≤ng th·ª≠ t·ª´ kh√≥a kh√°c.")
        except wikipedia.exceptions.DisambiguationError as e:
            o_ket_qua.delete(1.0, END)
            o_ket_qua.insert(END, f"'{noi_dung_tim_kiem}' c√≥ th·ªÉ c√≥ nhi·ªÅu nghƒ©a. Vui l√≤ng c·ª• th·ªÉ h∆°n. C√°c l·ª±a ch·ªçn: {e.options[:5]}...")
        except Exception as e:
            o_ket_qua.delete(1.0, END)
            o_ket_qua.insert(END, f"ƒê√£ x·∫£y ra l·ªói: {e}")

    # T·∫°o c·ª≠a s·ªï ch√≠nh
    cua_so = Tk()
    cua_so.title("6.T√¨m ki·∫øm th√¥ng tin")
    cua_so.geometry("600x400")

    # C·∫•u h√¨nh tr·ªçng s·ªë cho grid ƒë·ªÉ c√°c c·ªôt v√† h√†ng c√≥ th·ªÉ gi√£n n·ªü
    cua_so.grid_columnconfigure(0, weight=1) # L√†m cho c·ªôt 0 c√≥ th·ªÉ gi√£n ngang
    cua_so.grid_rowconfigure(2, weight=1)   # L√†m cho h√†ng 2 (ch·ª©a √¥ hi·ªÉn th·ªã k·∫øt qu·∫£) c√≥ th·ªÉ gi√£n d·ªçc

    # T·∫°o v√† ƒë·∫∑t c√°c widget s·ª≠ d·ª•ng .grid()
    nhan_huong_dan = Label(cua_so, text="Nh·∫≠p n·ªôi dung b·∫°n mu·ªën t√¨m hi·ªÉu:")
    nhan_huong_dan.grid(row=0, column=0, padx=10, pady=10, sticky="w") 

    o_nhap = Entry(cua_so, width=50)
    o_nhap.grid(row=1, column=0, padx=10, pady=5, sticky="ew") 
    o_nhap.bind("<Return>", lambda event=None: lay_thong_tin()) 

    nut_tim_kiem = Button(cua_so, text="T√¨m ki·∫øm", command=lay_thong_tin)
    nut_tim_kiem.grid(row=1, column=0, padx=10, pady=5, sticky="e") 

    o_ket_qua = ScrolledText(cua_so, wrap=WORD, width=70, height=15)
    o_ket_qua.grid(row=2, column=0, padx=10, pady=10, sticky="nsew") 
    cua_so.mainloop()
# T√≠nh nƒÉng 7: ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c
def dem_nguoc():
    def start_countdown():
        try:
            seconds = int(entry.get())
            if seconds < 0:
                raise ValueError("Th·ªùi gian kh√¥ng th·ªÉ √¢m.")
            countdown(seconds)
        except ValueError as e:
            messagebox.showerror("L·ªói", f"Vui l√≤ng nh·∫≠p m·ªôt s·ªë h·ª£p l·ªá: {e}")

    def countdown(seconds):
        if seconds >= 0:
            label.config(text=f"ƒê·∫øm ng∆∞·ª£c: {seconds} gi√¢y")
            root.after(1000, countdown, seconds - 1)
        else:
            label.config(text="H·∫øt gi·ªù!")

    root = Toplevel()
    root.title("7. ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c")
    root.resizable(False, False)
    ttk.Label(root, text="Nh·∫≠p th·ªùi gian (gi√¢y):").grid(column=0, row=0)
    entry = ttk.Entry(root); entry.grid(column=1, row=0)
    ttk.Button(root, text="B·∫Øt ƒë·∫ßu", command=start_countdown).grid(column=2, row=0)
    label = ttk.Label(root, text="ƒê·∫øm ng∆∞·ª£c: 0 gi√¢y", font=("Helvetica", 16))
    label.grid(column=0, row=1, columnspan=3)    
# T√≠nh nƒÉng 8: M√°y ph√°t nh·∫°c
pygame.mixer.init() 
current_file = None
music_list = []
playing_index = -1
paused = False
root = None
listbox = None
file_label = None
play_pause_button = None
def may_phat_nhac_va_video():

    def load_music_list():      # T·∫£i danh s√°ch nh·∫°c t·ª´ t·ªáp JSON
        global music_list
        if os.path.exists("music_list.json"):
            with open("music_list.json", "r", encoding='utf-8') as f:
                try:
                    music_list = json.load(f)
                except json.JSONDecodeError:
                    music_list = []
            # L·ªçc b·ªè c√°c ƒë∆∞·ªùng d·∫´n kh√¥ng t·ªìn t·∫°i ƒë·ªÉ tr√°nh l·ªói
                music_list = [path for path in music_list if os.path.exists(path)]

    def save_music_list():      #L∆∞u danh s√°ch nh·∫°c hi·ªán t·∫°i v√†o t·ªáp JSON
        global music_list
        with open("music_list.json", "w", encoding='utf-8') as f:
            json.dump(music_list, f, indent=4)

    def update_listbox():       #C·∫≠p nh·∫≠t n·ªôi dung c·ªßa widget listbox.
        global listbox
        listbox.delete(0,END)
        for i, path in enumerate(music_list):
            listbox.insert(END, f"{i+1}. {os.path.basename(path)}")
        highlight_playing_song()

    def highlight_playing_song():       # ƒê√°nh d·∫•u b√†i h√°t ƒëang ph√°t trong listbox.
        global listbox, playing_index
        listbox.selection_clear(0,END)
        if 0 <= playing_index < len(music_list):
            listbox.selection_set(playing_index)
            listbox.see(playing_index)

    def add_to_music_list():        # M·ªü h·ªôp tho·∫°i t·ªáp ƒë·ªÉ th√™m c√°c t·ªáp nh·∫°c v√†o danh s√°ch ph√°t.
        global music_list
        files_selected = filedialog.askopenfilenames(title="Ch·ªçn File Nh·∫°c", filetypes=[("File nh·∫°c (MP3, WAV)", "*.mp3;*.wav"), ("T·∫•t c·∫£", "*.*")])
        if files_selected:
            for file_path in files_selected:
                if file_path not in music_list: # Tr√°nh th√™m c√°c b√†i h√°t tr√πng l·∫∑p
                    music_list.append(file_path)
            update_listbox()
            save_music_list()

    def remove_selected_from_list(event=None):      # X√≥a c√°c b√†i h√°t ƒë√£ ch·ªçn kh·ªèi danh s√°ch ph√°t.
        global music_list, playing_index, current_file, file_label
        selected_indices = listbox.curselection()
        if not selected_indices:
            messagebox.showinfo("Th√¥ng b√°o", "Vui l√≤ng ch·ªçn b√†i h√°t ƒë·ªÉ x√≥a.")
            return
    # S·∫Øp x·∫øp c√°c ch·ªâ m·ª•c ƒë·ªÉ x√≥a theo th·ª© t·ª± gi·∫£m d·∫ßn ƒë·ªÉ tr√°nh thay ƒë·ªïi ch·ªâ m·ª•c khi x√≥a
        indices_to_remove = sorted(list(selected_indices), reverse=True)
    # ƒê·∫øm s·ªë l∆∞·ª£ng b√†i h√°t b·ªã x√≥a *tr∆∞·ªõc* b√†i h√°t ƒëang ph√°t ƒë·ªÉ ƒëi·ªÅu ch·ªânh playing_index
        removed_before_playing_count = 0
        original_playing_index = playing_index # L∆∞u ch·ªâ m·ª•c g·ªëc ƒë·ªÉ so s√°nh
        for idx in indices_to_remove:
            if idx == original_playing_index: # N·∫øu b√†i h√°t ƒëang ph√°t b·ªã x√≥a
                pygame.mixer.music.stop()
                current_file = None
                playing_index = -1 # ƒê·∫∑t l·∫°i playing_index
                file_label.config(text="Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c ch·ªçn")
                break # B√†i h√°t ƒëang ph√°t ƒë√£ ƒë∆∞·ª£c x·ª≠ l√Ω, kh√¥ng c·∫ßn ki·ªÉm tra th√™m
            if idx < original_playing_index:
                removed_before_playing_count += 1
    # X√≥a c√°c b√†i h√°t kh·ªèi danh s√°ch
        for index in indices_to_remove:
            del music_list[index]
    # ƒêi·ªÅu ch·ªânh playing_index sau khi x√≥a
        if playing_index != -1: # N·∫øu v·∫´n c√≤n b√†i h√°t ƒëang ph√°t (t·ª©c l√† kh√¥ng b·ªã x√≥a)
            playing_index -= removed_before_playing_count
    # ƒê·∫£m b·∫£o playing_index n·∫±m trong gi·ªõi h·∫°n h·ª£p l·ªá
            if playing_index >= len(music_list):
                playing_index = len(music_list) - 1 if len(music_list) > 0 else -1
            elif playing_index < 0 and len(music_list) > 0:
                playing_index = 0 # ƒê·∫∑t l·∫°i v·ªÅ b√†i h√°t ƒë·∫ßu ti√™n n·∫øu n√≥ tr·ªü th√†nh √¢m v√† v·∫´n c√≤n b√†i h√°t
            elif len(music_list) == 0:
                playing_index = -1
        update_listbox()
        save_music_list()
        highlight_playing_song()

    def play_selected_from_list(event=None):        # Ph√°t b√†i h√°t ƒë∆∞·ª£c ch·ªçn trong listbox.
        global playing_index, music_list
        selected_indices = listbox.curselection()
        if not selected_indices:
            return
        index = selected_indices[0]
        if 0 <= index < len(music_list):
            playing_index = index
            open_file(music_list[index])
            highlight_playing_song()

    def play_next():        # Ph√°t b√†i h√°t ti·∫øp theo trong danh s√°ch ph√°t.
        global music_list, playing_index
        if not music_list:
            messagebox.showinfo("Th√¥ng b√°o", "Danh s√°ch ph√°t tr·ªëng.")
            return
        playing_index = (playing_index + 1) % len(music_list)
        open_file(music_list[playing_index])
        highlight_playing_song()

    def play_previous(): #Ph√°t b√†i h√°t tr∆∞·ªõc ƒë√≥ trong danh s√°ch ph√°t.
        global music_list, playing_index
        if not music_list:
            messagebox.showinfo("Th√¥ng b√°o", "Danh s√°ch ph√°t tr·ªëng.")
            return
        playing_index = (playing_index - 1 + len(music_list)) % len(music_list)
        open_file(music_list[playing_index])
        highlight_playing_song()

    def select_and_open_file():
        global playing_index
        file_selected = filedialog.askopenfilenames(
            title="Ch·ªçn file",
            filetypes=[
                ("T·∫•t c·∫£ file media", "*.mp3;*.wav;*.mp4;*.avi;*.mkv"),
                ("File nh·∫°c (MP3, WAV)", "*.mp3;*.wav"),
                ("File video (MP4, AVI, MKV)", "*.mp4;*.avi;*.mkv"),
                ("T·∫•t c·∫£", "*.*")
            ]
        )
        if file_selected:
            playing_index = -1
            open_file(file_selected[0])  
            highlight_playing_song() 

    def open_file(file_path):       # M·ªü v√† ph√°t t·ªáp media ƒë√£ ch·ªâ ƒë·ªãnh.
        global current_file, file_label, music_list, playing_index
        if not os.path.exists(file_path):
            messagebox.showerror("L·ªói", f"File kh√¥ng t·ªìn t·∫°i: {file_path}")
        # N·∫øu t·ªáp kh√¥ng t·ªìn t·∫°i trong danh s√°ch ph√°t, h√£y x√≥a n√≥
            if file_path in music_list:
                music_list.remove(file_path)
                update_listbox()
                save_music_list()
            current_file = None
            file_label.config(text="Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c ch·ªçn")
            return

        current_file = file_path
        file_name = os.path.basename(file_path)
        file_label.config(text=f"ƒêang ph√°t: {file_name}")

        try:
            if file_path.lower().endswith(('.mp3', '.wav')):
                play_music(file_path)
            else:
                pygame.mixer.music.stop()
            # S·ª≠ d·ª•ng l·ªánh d√†nh ri√™ng cho t·ª´ng h·ªá ƒëi·ªÅu h√†nh ƒë·ªÉ m·ªü c√°c lo·∫°i media kh√°c
                if os.name == 'nt':  # ƒê·ªëi v·ªõi Windows
                    os.startfile(file_path)
                elif os.uname().sysname == 'Darwin':  # ƒê·ªëi v·ªõi macOS
                    subprocess.Popen(['open', file_path])
                else:  # ƒê·ªëi v·ªõi Linux/Unix
                    subprocess.Popen(['xdg-open', file_path])
        except Exception as e:
            messagebox.showerror("L·ªói m·ªü file", f"L·ªói: {e}")
            current_file = None
            file_label.config(text="Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c ch·ªçn")

    def play_music(music_path):     # T·∫£i v√† ph√°t t·ªáp nh·∫°c b·∫±ng pygame.mixer.
        global paused, play_pause_button, current_file, music_list, playing_index, root
        try:
            pygame.mixer.music.load(music_path)
            pygame.mixer.music.play()
            paused = False
            play_pause_button.config(text="T·∫°m D·ª´ng")
            pygame.mixer.music.set_endevent(pygame.USEREVENT)
            root.after(100, check_music_end) # B·∫Øt ƒë·∫ßu ki·ªÉm tra xem b√†i h√°t ƒë√£ k·∫øt th√∫c ch∆∞a
        except pygame.error as e:
            messagebox.showerror("L·ªói ph√°t nh·∫°c", f"Kh√¥ng th·ªÉ ph√°t nh·∫°c: {e}")
            current_file = None
            file_label.config(text="Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c ch·ªçn")
        # N·∫øu b√†i h√°t c√≥ v·∫•n ƒë·ªÅ l√† t·ª´ danh s√°ch ph√°t, h√£y x√≥a n√≥
            if playing_index != -1 and music_list[playing_index] == music_path:
                del music_list[playing_index]
                update_listbox()
                save_music_list()
                playing_index = -1

    def check_music_end():      # Ki·ªÉm tra xem nh·∫°c hi·ªán t·∫°i ƒë√£ k·∫øt th√∫c ch∆∞a v√† ph√°t b√†i h√°t ti·∫øp theo n·∫øu c√≥.
        global playing_index, music_list, current_file, file_label, root

        for event in pygame.event.get():
            if event.type == pygame.USEREVENT:
                if playing_index != -1 and playing_index < len(music_list) - 1:
                    play_next()
                else:
                # K·∫øt th√∫c danh s√°ch ph√°t ho·∫∑c ph√°t m·ªôt b√†i h√°t duy nh·∫•t
                    pygame.mixer.music.stop()
                    current_file = None
                    file_label.config(text="ƒê√£ ph√°t h·∫øt danh s√°ch")
                    playing_index = -1
                    highlight_playing_song()
                return # ƒê√£ x·ª≠ l√Ω s·ª± ki·ªán, d·ª´ng ki·ªÉm tra trong l·∫ßn l·∫∑p n√†y

    # Ti·∫øp t·ª•c ki·ªÉm tra ch·ªâ khi nh·∫°c ƒëang b·∫≠n ho·∫∑c t·∫°m d·ª´ng
        if pygame.mixer.music.get_busy() or pygame.mixer.music.get_paused():
            root.after(100, check_music_end)

    def toggle_play_pause():        # Chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i ph√°t/t·∫°m d·ª´ng c·ªßa nh·∫°c hi·ªán t·∫°i.
        global current_file, music_list, playing_index, paused, play_pause_button
        if not current_file:
            if music_list:
                playing_index = 0
                open_file(music_list[playing_index])
                highlight_playing_song()
            else:
                messagebox.showinfo("Th√¥ng b√°o", "Vui l√≤ng ch·ªçn m·ªôt file nh·∫°c tr∆∞·ªõc.")
            return
        if paused:
            pygame.mixer.music.unpause()
            play_pause_button.config(text="T·∫°m D·ª´ng")
            paused = False
        else:
            pygame.mixer.music.pause()
            play_pause_button.config(text="Ti·∫øp T·ª•c")
            paused = True

    def on_closing():       # X·ª≠ l√Ω s·ª± ki·ªán ƒë√≥ng c·ª≠a s·ªï, l∆∞u danh s√°ch ph√°t v√† d·ª´ng nh·∫°c.
        global root
        save_music_list()
        pygame.mixer.music.stop()
        root.destroy()

    global root, listbox, file_label, play_pause_button

    root = Toplevel()
    root.title("8. Ph√°t nh·∫°c v√† video")
    tinh_nang_8 = ttk.Frame(root, padding=10)
    tinh_nang_8.grid(row=0, column=0, sticky="nsew")

    root.grid_rowconfigure(0, weight=1)
    root.grid_columnconfigure(0, weight=1)

    load_music_list()

    # --- C√°c ph·∫ßn t·ª≠ giao di·ªán ng∆∞·ªùi d√πng ---

    # Nh√£n t·ªáp hi·ªán t·∫°i
    file_label = Label(tinh_nang_8, text="Ch∆∞a c√≥ file n√†o ƒë∆∞·ª£c ch·ªçn", anchor="w")
    file_label.grid(row=0, column=0, columnspan=4, sticky="ew", pady=(0, 10))

    # Khung n√∫t
    button_frame = ttk.Frame(tinh_nang_8)
    button_frame.grid(row=1, column=0, columnspan=4, pady=(0, 10))
    # C·∫•u h√¨nh c√°c c·ªôt trong button_frame ƒë·ªÉ m·ªü r·ªông ƒë·ªÅu
    button_frame.grid_columnconfigure(0, weight=1)
    button_frame.grid_columnconfigure(1, weight=1)
    button_frame.grid_columnconfigure(2, weight=1)
    button_frame.grid_columnconfigure(3, weight=1)

    play_pause_button = ttk.Button(button_frame, text="Ph√°t", command=toggle_play_pause)
    play_pause_button.grid(row=0, column=0, padx=5, sticky="ew")

    prev_button = ttk.Button(button_frame, text="B√†i Tr∆∞·ªõc", command=play_previous)
    prev_button.grid(row=0, column=1, padx=5, sticky="ew")

    next_button = ttk.Button(button_frame, text="B√†i K·∫ø", command=play_next)
    next_button.grid(row=0, column=2, padx=5, sticky="ew")

    open_file_button = ttk.Button(button_frame, text="M·ªü File", command=select_and_open_file)
    open_file_button.grid(row=0, column=3, padx=5, sticky="ew")

    # Nh√£n danh s√°ch ph√°t
    playlist_label = ttk.Label(tinh_nang_8, text="Danh s√°ch ph√°t:", anchor="w")
    playlist_label.grid(row=2, column=0, columnspan=4, sticky="ew", pady=(10, 5))

    # Listbox cho danh s√°ch nh·∫°c
    listbox_frame = ttk.Frame(tinh_nang_8)
    listbox_frame.grid(row=3, column=0, columnspan=4, sticky="nsew")
    tinh_nang_8.grid_rowconfigure(3, weight=1)
    tinh_nang_8.grid_columnconfigure(0, weight=1) # ƒê·∫£m b·∫£o khung listbox m·ªü r·ªông

    listbox = Listbox(listbox_frame, selectmode="extended")
    listbox.pack(side="left", fill="both", expand=True)

    scrollbar = Scrollbar(listbox_frame, orient="vertical", command=listbox.yview)
    scrollbar.pack(side="right", fill="y")
    listbox.config(yscrollcommand=scrollbar.set)

    # R√†ng bu·ªôc double click ƒë·ªÉ ph√°t b√†i h√°t ƒë√£ ch·ªçn
    listbox.bind("<Double-Button-1>", play_selected_from_list)

    # C√°c n√∫t ƒëi·ªÅu khi·ªÉn danh s√°ch ph√°t
    playlist_button_frame = ttk.Frame(tinh_nang_8)
    playlist_button_frame.grid(row=4, column=0, columnspan=4, pady=(10, 0))
    # C·∫•u h√¨nh c√°c c·ªôt trong playlist_button_frame
    playlist_button_frame.grid_columnconfigure(0, weight=1)
    playlist_button_frame.grid_columnconfigure(1, weight=1)


    add_to_list_button = ttk.Button(playlist_button_frame, text="Th√™m v√†o DS", command=add_to_music_list)
    add_to_list_button.grid(row=0, column=0, padx=5, sticky="ew")

    remove_from_list_button = ttk.Button(playlist_button_frame, text="X√≥a kh·ªèi DS", command=remove_selected_from_list)
    remove_from_list_button.grid(row=0, column=1, padx=5, sticky="ew")

    # C·∫≠p nh·∫≠t listbox ban ƒë·∫ßu
    update_listbox()

    # Giao th·ª©c ƒë√≥ng c·ª≠a s·ªï
    root.protocol("WM_DELETE_WINDOW", on_closing)

    root.mainloop()
# T√≠nh nƒÉng 9: Vi·∫øt vƒÉn b·∫£n
def van_ban():
    root = Toplevel()
    root.title("9. Vi·∫øt vƒÉn b·∫£n")
    text_area = Text(root, wrap="word", font=("Arial", 12))
    text_area.pack(expand=True, fill="both")
    
    def save_file():
        file_path = filedialog.asksaveasfilename(defaultextension=".txt", filetypes=[("Text files", "*.txt"), ("All files", "*.*")])
        if file_path:
            with open(file_path, "w", encoding="utf-8") as file:
                file.write(text_area.get("1.0", END))
            messagebox.showinfo("Th√¥ng b√°o", "T·ªáp ƒë√£ ƒë∆∞·ª£c l∆∞u th√†nh c√¥ng.")
    
    def open_file():
        file_path = filedialog.askopenfilename(filetypes=[("Text files", "*.txt"), ("All files", "*.*")])
        if file_path:
            with open(file_path, "r", encoding="utf-8") as file:
                text_area.delete("1.0", END)
                text_area.insert("1.0", file.read())
    
    ttk.Button(root, text="L∆∞u t·ªáp", command=save_file).pack(side=LEFT, padx=5, pady=5)
    ttk.Button(root, text="M·ªü t·ªáp", command=open_file).pack(side=LEFT, padx=5, pady=5)
    root.mainloop()
# T√≠nh nƒÉng 10: Th·ªùi ti·∫øt 
CONFIG_FILE = "config.ini"
VALID_CITIES_FILE = "valid_cities.txt"
def thoi_tiet():
    def save_api_key(api_key):
        config = configparser.ConfigParser()
        config['Settings'] = {'API_Key': api_key}
        try:
            with open(CONFIG_FILE, 'w', encoding='utf-8') as configfile:
                config.write(configfile)
        except Exception as e:
            messagebox.showerror("L·ªói l∆∞u", f"Kh√¥ng th·ªÉ l∆∞u kh√≥a API: {e}")

    def load_api_key():
        config = configparser.ConfigParser()
        if os.path.exists(CONFIG_FILE):
            config.read(CONFIG_FILE, encoding='utf-8')
            return config.get('Settings', 'API_Key', fallback="")
        return ""

    def save_valid_city(city):
        """L∆∞u t√™n th√†nh ph·ªë v√†o file n·∫øu ch∆∞a t·ªìn t·∫°i."""
        if not os.path.exists(VALID_CITIES_FILE):
            with open(VALID_CITIES_FILE, 'w', encoding='utf-8') as file:
                file.write(f"{city}\n")
        else:
            with open(VALID_CITIES_FILE, 'r+', encoding='utf-8') as file:
                cities = file.read().splitlines()
                if city not in cities:
                    file.write(f"{city}\n")
                    city_listbox.insert(END, city)  # Th√™m v√†o danh s√°ch hi·ªÉn th·ªã

    def load_valid_cities():
        """T·∫£i danh s√°ch c√°c t·ªânh/th√†nh ph·ªë ƒë√£ nh·∫≠p ƒë√∫ng."""
        if os.path.exists(VALID_CITIES_FILE):
            with open(VALID_CITIES_FILE, 'r', encoding='utf-8') as file:
                return file.read().splitlines()
        return []

    def get_weather_data():
        city = city_entry.get().strip()
        api_key = api_key_entry.get().strip()

        if not city:
            messagebox.showwarning("L·ªói", "Vui l√≤ng nh·∫≠p t√™n th√†nh ph·ªë.")
            return

        if not api_key:
            messagebox.showwarning("L·ªói", "Vui l√≤ng nh·∫≠p kh√≥a API c·ªßa b·∫°n. N·∫øu ch∆∞a c√≥ vui l√≤ng truy c·∫≠p v√†o api.openweathermap.org ƒë·ªÉ l·∫•y kh√≥a API mi·ªÖn ph√≠ ")
            return
        
        save_api_key(api_key)

        city = unidecode(city)

        ow_url = "http://api.openweathermap.org/data/2.5/weather?"
        call_url = f"{ow_url}appid={api_key}&q={city}&units=metric"

        try:
            response = requests.get(call_url)
            data = response.json()

            if data["cod"] == 200:
                save_valid_city(city)  # L∆∞u th√†nh ph·ªë h·ª£p l·ªá v√†o danh s√°ch

                weather_info = f"""
üå°Ô∏è Nhi·ªát ƒë·ªô: {data['main']['temp']}¬∞C
üå¨Ô∏è √Åp su·∫•t: {data['main']['pressure']} hPa
üí¶ ƒê·ªô ·∫©m: {data['main']['humidity']}%
‚òÅÔ∏è Th·ªùi ti·∫øt: {data['weather'][0]['description'].capitalize()}
"""
                result_label.config(text=weather_info)
            else:
                result_label.config(text="Kh√¥ng t√¨m th·∫•y ƒë·ªãa ch·ªâ.")
                messagebox.showerror("L·ªói", "Kh√¥ng t√¨m th·∫•y th√†nh ph·ªë, vui l√≤ng ki·ªÉm tra l·∫°i.")

        except requests.exceptions.ConnectionError:
            messagebox.showerror("L·ªói m·∫°ng", "Kh√¥ng th·ªÉ k·∫øt n·ªëi ƒë·∫øn d·ªãch v·ª• th·ªùi ti·∫øt, ki·ªÉm tra internet c·ªßa b·∫°n.")
        except Exception as e:
            messagebox.showerror("L·ªói", f"C√≥ l·ªói x·∫£y ra: {e}")

    def select_city_from_list(event):
        """Cho ph√©p ch·ªçn th√†nh ph·ªë t·ª´ danh s√°ch b√™n tr√°i."""
        selected_city = city_listbox.get(city_listbox.curselection())
        city_entry.delete(0, END)
        city_entry.insert(0, selected_city)

    root = Tk()
    root.title("10.Th·ªùi ti·∫øt")
    root.geometry("500x300")

    # --- Giao di·ªán ---
    left_frame = Frame(root)
    left_frame.pack(side=LEFT, padx=5, pady=5)

    Label(left_frame, text="Danh s√°ch t·ªânh/th√†nh ph·ªë:", font=("Arial", 12)).pack()

    city_listbox = Listbox(left_frame, height=10, width=25)
    city_listbox.pack(pady=5)

    for city in load_valid_cities():
        city_listbox.insert(END, city)

    city_listbox.bind("<<ListboxSelect>>", select_city_from_list)

    right_frame = Frame(root)
    right_frame.pack(side=RIGHT, padx=10, pady=10)

    Label(right_frame, text="Nh·∫≠p m√£ API:", font=("Arial", 12)).pack(pady=5)
    api_key_entry = Entry(right_frame, width=35, font=("Arial", 12), show="*")
    api_key_entry.pack(pady=5)

    saved_api_key = load_api_key()
    if saved_api_key:
        api_key_entry.insert(0, saved_api_key)

    Label(right_frame, text="Nh·∫≠p t√™n th√†nh ph·ªë:", font=("Arial", 12)).pack(pady=5)
    city_entry = Entry(right_frame, width=35, font=("Arial", 12))
    city_entry.pack(pady=5)

    Button(right_frame, text="Xem th·ªùi ti·∫øt", command=get_weather_data, font=("Arial", 12)).pack(pady=10)

    result_label = Label(right_frame, text="Th√¥ng tin th·ªùi ti·∫øt s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y.", font=("Arial", 10))
    result_label.pack(pady=10)

    root.mainloop()
# T√≠nh nƒÉng 11: Thay ƒë·ªïi giao di·ªán ng∆∞·ªùi d√πng
def giao_dien():
    root= None
    def ap_dung_chu_de(background_color, foreground_color):
        global root
        if root:
            root.configure(bg=background_color)
            style = ttk.Style()
            style.configure(".", background=background_color, foreground=foreground_color, font=('Arial', 10), relief="raised", padding=8, borderwidth=2)
    def chon_mau():
        color_code = colorchooser.askcolor(title="Ch·ªçn m√†u n·ªÅn t√πy ch·ªânh")
        if color_code[1]:
            ap_dung_chu_de(color_code[1], "black")  # M·∫∑c ƒë·ªãnh ch·ªØ ƒëen


    root = Toplevel()
    root.title("11. Thay ƒë·ªïi giao di·ªán ng∆∞·ªùi d√πng")
    tinh_nang_11 = ttk.Frame(root, padding=15)
    tinh_nang_11.grid()
    ttk.Label(tinh_nang_11, text="Ch·ªçn M√†u Giao di·ªán:", font=('Arial', 14, 'bold')).grid(row=0, column=0, pady=10)
    ttk.Button(tinh_nang_11, text="M√†u T√πy Ch·ªânh", command=chon_mau).grid(row=1, column=0, sticky="ew", pady=5)
    root.mainloop()
# T√≠nh nƒÉng 12: B·∫£ng tu·∫ßn ho√†n h√≥a h·ªçc
root = None
loading_frame = None
loading_label = None
cache_file = "periodic_table_data.json"
periodic_elements = []

periodic_table_frame = None
info_frame = None
info_text_area = None
def bang_tuan_hoan():

    def load_or_restore_element_data(url, current_loading_label, current_root):
        global periodic_elements

    # 1. Th·ª≠ t·∫£i t·ª´ cache
        if os.path.exists(cache_file):
            try:
                current_loading_label.config(text="ƒêang t·∫£i d·ªØ li·ªáu t·ª´ cache...")
                current_root.update_idletasks()
                with open(cache_file, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                if 'elements' in data and isinstance(data['elements'], list):
                    periodic_elements = sorted(data['elements'], key=lambda x: x['number'])
                    current_loading_label.config(text="ƒê√£ t·∫£i d·ªØ li·ªáu t·ª´ cache.")
                    return True
                else:
                    print("D·ªØ li·ªáu cache kh√¥ng h·ª£p l·ªá, s·∫Ω t·∫£i l·∫°i.")
            except (json.JSONDecodeError, IOError) as e:
                print(f"L·ªói khi ƒë·ªçc file cache: {e}. S·∫Ω th·ª≠ t·∫£i l·∫°i t·ª´ internet.")
    # 2. N·∫øu kh√¥ng c√≥ cache ho·∫∑c cache b·ªã l·ªói, t·∫£i t·ª´ internet
        current_loading_label.config(text="ƒêang t·∫£i d·ªØ li·ªáu t·ª´ internet...")
        current_root.update_idletasks()
        try:
            response = requests.get(url, stream=True) # Use stream=True for progress
            response.raise_for_status()
        
            json_data_chunks = []
            for chunk in response.iter_content(chunk_size=8192):
                json_data_chunks.append(chunk)

            data = json.loads(b''.join(json_data_chunks).decode('utf-8'))
            periodic_elements = sorted(data['elements'], key=lambda x: x['number'])

            # L∆∞u d·ªØ li·ªáu v√†o cache
            try:
                with open(cache_file, 'w', encoding='utf-8') as f:
                    json.dump(data, f, indent=4, ensure_ascii=False)
                print(f"ƒê√£ l∆∞u d·ªØ li·ªáu v√†o cache: {cache_file}")
            except IOError as e:
                print(f"L·ªói khi l∆∞u d·ªØ li·ªáu v√†o cache: {e}")

            return True

        except requests.exceptions.RequestException as e:
            print(f"L·ªói khi t·∫£i d·ªØ li·ªáu t·ª´ internet: {e}")
            return False
        except json.JSONDecodeError as e:
            print(f"L·ªói gi·∫£i m√£ JSON t·ª´ internet: {e}")
            return False     

    def create_widgets(current_root, current_loading_frame):
        global periodic_table_frame, info_frame, info_text_area

    # ·∫®n khung t·∫£i
        current_loading_frame.destroy()

    # C·∫•u h√¨nh grid cho root window
        current_root.grid_rowconfigure(0, weight=1) # H√†ng 0 s·∫Ω gi√£n n·ªü theo chi·ªÅu d·ªçc
        current_root.grid_columnconfigure(0, weight=4) # C·ªôt 0 (khung b·∫£ng tu·∫ßn ho√†n) s·∫Ω gi√£n n·ªü nhi·ªÅu h∆°n theo chi·ªÅu ngang
        current_root.grid_columnconfigure(1, weight=1) # C·ªôt 1 (khung th√¥ng tin) s·∫Ω gi√£n n·ªü √≠t h∆°n theo chi·ªÅu ngang

    # Khung ch·ª©a b·∫£ng tu·∫ßn ho√†n
        periodic_table_frame = Frame(current_root, bg="#F0F0F0", padx=10, pady=10)
        periodic_table_frame.grid(row=0, column=0, sticky="nsew") # ƒê·∫∑t ·ªü h√†ng 0, c·ªôt 0 v√† gi√£n n·ªü

    # Khung hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt nguy√™n t·ªë
        info_frame = Frame(current_root, bg="#E0E0E0", width=300, padx=10, pady=10, bd=2, relief="groove")
        info_frame.grid(row=0, column=1, sticky="nsew") # ƒê·∫∑t ·ªü h√†ng 0, c·ªôt 1 v√† gi√£n n·ªü
        info_frame.grid_propagate(False) # NgƒÉn khung th√¥ng tin thay ƒë·ªïi k√≠ch th∆∞·ªõc

    # C·∫•u h√¨nh grid cho info_frame
        info_frame.grid_rowconfigure(1, weight=1) # D√≤ng cho info_text_area s·∫Ω gi√£n n·ªü
        info_frame.grid_columnconfigure(0, weight=1) # C·ªôt duy nh·∫•t s·∫Ω gi√£n n·ªü

        info_label = Label(info_frame, text="Th√¥ng tin Nguy√™n t·ªë", font=("Arial", 14, "bold"), bg="#E0E0E0", fg="#333333")
        info_label.grid(row=0, column=0, pady=10) # ƒê·∫∑t ·ªü h√†ng 0, c·ªôt 0 trong info_frame

    # V√πng vƒÉn b·∫£n c√≥ th·ªÉ cu·ªôn ƒë·ªÉ hi·ªÉn th·ªã th√¥ng tin chi ti·∫øt
        info_text_area = scrolledtext.ScrolledText(info_frame, wrap=WORD, font=("Arial", 10), width=35, height=25,
                                                   bg="#F8F8F8", fg="#000000", bd=1, relief="solid", padx=5, pady=5)
        info_text_area.grid(row=1, column=0, pady=5, sticky="nsew") # ƒê·∫∑t ·ªü h√†ng 1, c·ªôt 0 v√† gi√£n n·ªü
        info_text_area.config(state=DISABLED) # Ban ƒë·∫ßu kh√¥ng cho ch·ªânh s·ª≠a

        display_periodic_table()
        add_category_legend()
    
    def display_periodic_table():
        # C·∫•u h√¨nh l∆∞·ªõi cho periodic_table_frame ƒë·ªÉ c√°c h√†ng v√† c·ªôt gi√£n ra
        for i in range(10): # C√≥ th·ªÉ c·∫ßn nhi·ªÅu h√†ng h∆°n cho lanthanides/actinides
            periodic_table_frame.grid_rowconfigure(i, weight=1)
        for i in range(18): # 18 c·ªôt cho c√°c nh√≥m
            periodic_table_frame.grid_columnconfigure(i, weight=1)

    # ƒê·ªãnh nghƒ©a v·ªã tr√≠ b·∫Øt ƒë·∫ßu cho Lanthanides v√† Actinides n·∫øu hi·ªÉn th·ªã ri√™ng
        lant_row_start = 8
        act_row_start = 9
        lant_act_col_offset = 3 # C·ªôt b·∫Øt ƒë·∫ßu t∆∞∆°ng ƒë·ªëi

        for element in periodic_elements:
            symbol = element['symbol']
            atomic_number = element['number']
            category = element['category']
            period = element['period']
            xpos = element['xpos']
            ypos = element['ypos']

            background_color = get_color_by_category(category)

        # ƒêi·ªÅu ch·ªânh v·ªã tr√≠ cho Lanthanides v√† Actinides
            if category in ["lanthanide", "actinide"]:
                if category == "lanthanide":
                    row = lant_row_start
                else: # actinide
                    row = act_row_start
            
            # T√≠nh to√°n c·ªôt d·ª±a tr√™n s·ªë th·ª© t·ª± trong series ƒë√≥
                if atomic_number >= 57 and atomic_number <= 71: # Lanthanides
                    col = lant_act_col_offset + (atomic_number - 57)
                elif atomic_number >= 89 and atomic_number <= 103: # Actinides
                    col = lant_act_col_offset + (atomic_number - 89)
                else: # C√°c nguy√™n t·ªë kh√°c trong nh√≥m f-block nh∆∞ng kh√¥ng thu·ªôc series ch√≠nh
                    row = ypos - 1
                    col = xpos - 1
            else:
                row = ypos - 1 # ypos trong JSON b·∫Øt ƒë·∫ßu t·ª´ 1
                col = xpos - 1 # xpos trong JSON b·∫Øt ƒë·∫ßu t·ª´ 1

        # T·∫°o n√∫t cho m·ªói nguy√™n t·ªë
            element_button = Button(periodic_table_frame,
                                    text=f"{atomic_number}\n{symbol}",
                                    command=lambda e=element: display_element_info(e),
                                    bg=background_color,
                                    fg="black",
                                    font=("Arial", 9, "bold"),
                                    width=5, height=3,
                                    bd=1, relief="raised")
            element_button.grid(row=row, column=col, padx=1, pady=1, sticky="nsew")

    # Th√™m c√°c n√∫t gi·ªØ ch·ªó cho Lanthanides v√† Actinides ·ªü v·ªã tr√≠ ban ƒë·∫ßu
        placeholder_la_button = Button(periodic_table_frame, text="57-71\nLa-Lu", bg="#D0D0D0", fg="black",
                                       font=("Arial", 9, "bold"), width=5, height=3, bd=1, relief="raised")
        placeholder_la_button.grid(row=5, column=2, padx=1, pady=1, sticky="nsew")

        placeholder_ac_button = Button(periodic_table_frame, text="89-103\nAc-Lr", bg="#D0D0D0", fg="black",
                                       font=("Arial", 9, "bold"), width=5, height=3, bd=1, relief="raised")
        placeholder_ac_button.grid(row=6, column=2, padx=1, pady=1, sticky="nsew")

    def get_color_by_category(category):
        colors = {
            "alkali metal": "#FF9999",          # Kim lo·∫°i ki·ªÅm (ƒê·ªè nh·∫°t)
            "alkaline earth metal": "#FFCC99", # Kim lo·∫°i ki·ªÅm th·ªï (Cam nh·∫°t)
            "metalloid": "#FFFF99",             # √Å kim (V√†ng nh·∫°t)
            "nonmetal": "#CCFFCC",              # Phi kim (Xanh l√° nh·∫°t)
            "noble gas": "#99CCFF",             # Kh√≠ hi·∫øm (Xanh d∆∞∆°ng nh·∫°t)
            "halogen": "#CC99FF",               # Halogen (T√≠m nh·∫°t)
            "transition metal": "#FFCCCC",      # Kim lo·∫°i chuy·ªÉn ti·∫øp (H·ªìng)
            "post-transition metal": "#CCCCFF", # Kim lo·∫°i sau chuy·ªÉn ti·∫øp (O·∫£i h∆∞∆°ng)
            "lanthanide": "#FFCCFF",            # Lanthanide (H·ªìng c√°nh sen nh·∫°t)
            "actinide": "#FF99FF",              # Actinide (H·ªìng ƒë·∫≠m h∆°n)
            "unknown, probably transition metal": "#D3D3D3", # Kh√¥ng x√°c ƒë·ªãnh (X√°m nh·∫°t)
            "unknown, probably post-transition metal": "#D3D3D3", # Kh√¥ng x√°c ƒë·ªãnh (X√°m nh·∫°t)
            "unknown, probably metalloid": "#D3D3D3", # Kh√¥ng x√°c ƒë·ªãnh (X√°m nh·∫°t)
            "unknown, predicted to be noble gas": "#D3D3D3" # Kh√¥ng x√°c ƒë·ªãnh (X√°m nh·∫°t)
        }
        return colors.get(category, "#E0E0E0") # M√†u m·∫∑c ƒë·ªãnh l√† x√°m nh·∫°t

    def display_element_info(element):
    
        info_text = f"T√™n: {element.get('name', 'N/A')}\n" \
                    f"K√Ω hi·ªáu: {element.get('symbol', 'N/A')}\n" \
                    f"S·ªë Nguy√™n T·ª≠: {element.get('number', 'N/A')}\n" \
                    f"Kh·ªëi L∆∞·ª£ng Nguy√™n T·ª≠: {element.get('atomic_mass', 'N/A')} u\n" \
                    f"Lo·∫°i: {element.get('category', 'N/A').replace('_', ' ').title()}\n" \
                    f"Chu K·ª≥: {element.get('period', 'N/A')}\n" \
                    f"Nh√≥m: {element.get('group', 'N/A')}\n"\
                    f"ƒêi·ªán √Çm (Pauling): {element.get('electronegativity_pauling', 'N/A')}\n" \
                    f"M·∫≠t ƒê·ªô: {element.get('density', 'N/A')} g/cm¬≥\n" \
                    f"ƒêi·ªÉm N√≥ng Ch·∫£y: {element.get('melt', 'N/A')} K\n" \
                    f"ƒêi·ªÉm S√¥i: {element.get('boil', 'N/A')} K\n" \
                    f"Ng∆∞·ªùi Ph√°t Hi·ªán: {element.get('discovered_by', 'N/A')}"

        info_text_area.config(state=NORMAL) # Cho ph√©p ch·ªânh s·ª≠a t·∫°m th·ªùi ƒë·ªÉ c·∫≠p nh·∫≠t n·ªôi dung
        info_text_area.delete(1.0, END) # X√≥a n·ªôi dung c≈©
        info_text_area.insert(END, info_text) # Ch√®n th√¥ng tin m·ªõi
        info_text_area.config(state=DISABLED) # Kh√≥a l·∫°i sau khi c·∫≠p nh·∫≠t

    def add_category_legend():
        """Th√™m ch√∫ gi·∫£i m√†u s·∫Øc cho c√°c lo·∫°i nguy√™n t·ªë."""
        legend_frame = Frame(info_frame, bg="#E0E0E0", pady=10)
        legend_frame.grid(row=2, column=0, sticky="ew") # ƒê·∫∑t ·ªü h√†ng 2, c·ªôt 0 trong info_frame v√† gi√£n n·ªü

    # Ti√™u ƒë·ªÅ ch√∫ gi·∫£i
        Label(legend_frame, text="Ch√∫ Gi·∫£i M√†u S·∫Øc:", font=("Arial", 11, "bold"), bg="#E0E0E0").grid(row=0, column=0, columnspan=2, pady=5, sticky="w")

    # ƒê·ªãnh nghƒ©a c√°c lo·∫°i nguy√™n t·ªë v√† t√™n hi·ªÉn th·ªã ti·∫øng Vi·ªát
        categories = {
            "kim lo·∫°i ki·ªÅm": "alkali metal",
            "kim lo·∫°i ki·ªÅm th·ªï": "alkaline earth metal",
            "√° kim": "metalloid",
            "phi kim": "nonmetal",
            "kh√≠ hi·∫øm": "noble gas",
            "halogen": "halogen",
            "kim lo·∫°i chuy·ªÉn ti·∫øp": "transition metal",
            "kim lo·∫°i sau chuy·ªÉn ti·∫øp": "post-transition metal",
            "lanthanide": "lanthanide",
            "actinide": "actinide",
            "kh√¥ng x√°c ƒë·ªãnh": "unknown, probably transition metal" # D√πng m·ªôt m√†u ƒë·∫°i di·ªán cho unknown
        }

        row_idx = 1 # B·∫Øt ƒë·∫ßu t·ª´ h√†ng 1, v√¨ h√†ng 0 l√† ti√™u ƒë·ªÅ ch√∫ gi·∫£i
        for display_name, category_key in categories.items():
            color = get_color_by_category(category_key)
        
        # √î m√†u s·∫Øc
            Label(legend_frame, bg=color, width=3, height=1, bd=1, relief="solid").grid(row=row_idx, column=0, padx=5, pady=1, sticky="w")
        # Nh√£n vƒÉn b·∫£n
            Label(legend_frame, text=display_name.title(), font=("Arial", 9), bg="#E0E0E0").grid(row=row_idx, column=1, padx=0, pady=1, sticky="w")
            row_idx += 1

        legend_frame.grid_columnconfigure(1, weight=1) # Cho ph√©p c·ªôt ch·ª©a vƒÉn b·∫£n gi√£n n·ªü

    global root, loading_frame, loading_label

    root = Toplevel()
    root.title("12.B·∫£ng Tu·∫ßn Ho√†n H√≥a H·ªçc")
    root.geometry("1200x800")
    root.configure(bg="#F0F0F0")

    # Khung ch·ª©a th√¥ng b√°o t·∫£i d·ªØ li·ªáu ban ƒë·∫ßu
    loading_frame = Frame(root, bg="#F0F0F0")
    loading_frame.pack(expand=True, fill=BOTH) # V·∫´n d√πng pack cho khung t·∫£i ban ƒë·∫ßu ƒë·ªÉ d·ªÖ d√†ng cƒÉn gi·ªØa

    loading_label = Label(loading_frame, text="ƒêang kh·ªüi t·∫°o...", font=("Arial", 16, "bold"), bg="#F0F0F0")
    loading_label.pack(pady=50)

    # C·∫≠p nh·∫≠t giao di·ªán ƒë·ªÉ hi·ªÉn th·ªã khung t·∫£i ngay l·∫≠p t·ª©c
    root.update_idletasks()

    # T·∫£i ho·∫∑c kh√¥i ph·ª•c d·ªØ li·ªáu nguy√™n t·ªë
    data_loaded_successfully = load_or_restore_element_data(
        "https://raw.githubusercontent.com/Bowserinator/Periodic-Table-JSON/master/PeriodicTableJSON.json",
        loading_label, root
    )

    if not data_loaded_successfully:
        messagebox.showerror("L·ªói", "Kh√¥ng th·ªÉ t·∫£i ho·∫∑c kh√¥i ph·ª•c d·ªØ li·ªáu b·∫£ng tu·∫ßn ho√†n. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi internet ho·∫∑c file cache.")
        root.destroy()
        return
    
    # T·∫°o v√† hi·ªÉn th·ªã c√°c widgets ch√≠nh sau khi t·∫£i d·ªØ li·ªáu
    # loading_frame s·∫Ω b·ªã h·ªßy b·ªè v√† c√°c widget ch√≠nh s·∫Ω d√πng grid
    create_widgets(root, loading_frame)

    root.mainloop()

# T√≠nh nƒÉng 13: ƒê√¥i l·ªùi c·ªßa nh√† s·∫£n xu·∫•t
def doi_loi():
    root = Toplevel()
    root.title("13. L·ªùi nh·∫Øn t·ª´ nh√† ph√°t tri·ªÉn") # Ti√™u ƒë·ªÅ th√¢n thi·ªán h∆°n
    
    # ƒê·ªãnh nghƒ©a n·ªôi dung th√¥ng ƒëi·ªáp
    message = (
        "Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi ·ª©ng d·ª•ng c·ªßa ch√∫ng t√¥i!\n\n" # Th√™m d√≤ng tr·ªëng ƒë·ªÉ d·ªÖ ƒë·ªçc
        "Ch√∫ng t√¥i ƒë√£ t·∫°o ra ·ª©ng d·ª•ng n√†y v·ªõi mong mu·ªën mang l·∫°i nh·ªØng t√≠nh nƒÉng h·ªØu √≠ch "
        "v√† tr·∫£i nghi·ªám th√∫ v·ªã cho b·∫°n.\n\n" # Ng·∫Øt d√≤ng h·ª£p l√Ω
        "N·∫øu b·∫°n c√≥ b·∫•t k·ª≥ c√¢u h·ªèi, g√≥p √Ω, ho·∫∑c c·∫ßn h·ªó tr·ª£, "
        "xin ƒë·ª´ng ng·∫ßn ng·∫°i li√™n h·ªá v·ªõi ch√∫ng t√¥i.\n\n" # L·ªùi k√™u g·ªçi h√†nh ƒë·ªông r√µ r√†ng
        "Ch√¢n th√†nh c·∫£m ∆°n b·∫°n ƒë√£ tin t∆∞·ªüng v√† s·ª≠ d·ª•ng ·ª©ng d·ª•ng!\n\n"
        "Tr√¢n tr·ªçng,\n\n"
        "ƒê·ªôi ng≈© ph√°t tri·ªÉn: ƒêinh Vi·∫øt Ph√∫c v√† Ng√¥ VƒÉn Anh Khoa." 
    )
    ttk.Label(root, 
              text=message, 
              wraplength=400, 
              justify="left", 
              font=("Arial", 10)).pack(padx=20, pady=20) 
    
    root.mainloop()

root = Tk() 
root.title("App_ƒëa_nƒÉng(beta)")
frm = ttk.Frame(root, padding=10)
frm.grid(row=0, column=0, sticky="nsew")

root.grid_rowconfigure(0, weight=1)    
root.grid_columnconfigure(0, weight=1) 

ttk.Label(frm, text="Menu", anchor="center", font=('Arial', 14, 'bold')).grid(column=0, row=0, columnspan=2, sticky="ew", pady=5) 
ttk.Button(frm, text="1.ƒê·ªìng h·ªì v√† l·ªãch", command=clock).grid(column=0, row=1, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="2.M√°y ·∫£nh", command=camera).grid(column=0, row=2, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="3.G·ª≠i th∆∞", command=gui_thu).grid(column=0, row=3, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="4.M√°y t√≠nh", command=may_tinh).grid(column=0, row=4, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="5.Chuy·ªÉn √¢m thanh th√†nh vƒÉn b·∫£n", command=chuyen_am_thanh_thanh_van_ban).grid(column=0, row=5, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="6.T√¨m ki·∫øm th√¥ng tin ", command=tim_kiem_thong_tin).grid(column=0, row=6, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="7. ƒê·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c", command=dem_nguoc).grid(column=0, row=7, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="8. M√°y ph√°t nh·∫°c v√† video ", command=may_phat_nhac_va_video).grid(column=0, row=8, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="9. Vi·∫øt vƒÉn b·∫£n ", command=van_ban).grid(column=0, row=9, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="10. Th·ªùi ti·∫øt", command=thoi_tiet).grid(column=0, row=10, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="11.Thay ƒë·ªïi giao di·ªán ng∆∞·ªùi d√πng ", command=giao_dien).grid(column=0, row=11, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="12.B·∫£ng tu·∫ßn ho√†n h√≥a h·ªçc", command=bang_tuan_hoan).grid(column=0, row=12, columnspan=2, sticky="ew", pady=2)
ttk.Button(frm, text="13. ƒê√¥i l·ªùi c·ªßa nh√† s·∫£n xu·∫•t ", command=doi_loi).grid(column=0, row=13, columnspan=2, sticky="ew", pady=2)

frm.grid_columnconfigure(0, weight=1) 
frm.grid_columnconfigure(1, weight=1) 

root.mainloop()
